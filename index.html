<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FriendSF Draft League</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@400;600&display=swap');

      body {
        font-family: 'Inter', sans-serif;
        background-color: #0a0a0a;
        background-image: radial-gradient(
          circle at center,
          #1a1a1a 0%,
          #000000 100%
        );
        color: #d1d5db;
      }

      h1,
      h2,
      h3,
      .poe-font {
        font-family: 'Cinzel', serif;
      }

      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #1f1f1f;
      }
      ::-webkit-scrollbar-thumb {
        background: #555;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #777;
      }

      .gem-card {
        transition: all 0.3s ease;
        border: 1px solid #333;
        display: flex;
        flex-direction: column;
      }

      .gem-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        border-color: #555;
      }

      .spin-animation {
        animation: spin 0.1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: translateY(0);
          opacity: 0.8;
        }
        100% {
          transform: translateY(-5px);
          opacity: 0.4;
        }
      }

      .locked-gem {
        border: 2px solid #fbbf24 !important;
        background-color: rgba(40, 30, 10, 0.9) !important;
        box-shadow: 0 0 20px rgba(251, 191, 36, 0.3) !important;
      }

      .dimmed-card {
        opacity: 0.4;
        pointer-events: none;
        filter: grayscale(0.8);
      }

      .locked-text {
        color: #fbbf24;
        text-shadow: 0 0 5px rgba(251, 191, 36, 0.5);
      }

      .variant-row {
        border-bottom: 1px solid #333;
      }
      .variant-row:last-child {
        border-bottom: none;
      }

      /* CSS Gem Graphic */
      .gem-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin: 0 auto 20px auto;
        box-shadow: inset -10px -10px 20px rgba(0, 0, 0, 0.5),
          inset 10px 10px 20px rgba(255, 255, 255, 0.4);
        border: 2px solid rgba(255, 255, 255, 0.1);
      }

      .gem-red {
        background: radial-gradient(circle at 30% 30%, #ef4444, #7f1d1d);
        box-shadow: 0 0 25px rgba(239, 68, 68, 0.6),
          inset -10px -10px 20px rgba(0, 0, 0, 0.5);
      }
      .gem-green {
        background: radial-gradient(circle at 30% 30%, #22c55e, #14532d);
        box-shadow: 0 0 25px rgba(34, 197, 94, 0.6),
          inset -10px -10px 20px rgba(0, 0, 0, 0.5);
      }
      .gem-blue {
        background: radial-gradient(circle at 30% 30%, #3b82f6, #1e3a8a);
        box-shadow: 0 0 25px rgba(59, 130, 246, 0.6),
          inset -10px -10px 20px rgba(0, 0, 0, 0.5);
      }
    </style>
  </head>
  <body class="min-h-screen flex flex-col items-center py-10 px-4">
    <header class="text-center mb-12">
      <h1
        class="text-5xl md:text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-b from-amber-100 to-amber-600 mb-4 drop-shadow-lg"
      >
        FriendSF Draft
      </h1>
    </header>

    <div class="w-full max-w-6xl grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
      <div
        id="card-red"
        class="gem-card bg-neutral-900 rounded-xl p-6 relative overflow-hidden min-h-[500px]"
      >
        <div
          class="absolute top-0 left-0 w-full h-1 bg-red-600 shadow-[0_0_10px_rgba(220,38,38,0.8)]"
        ></div>
        <h2
          class="text-red-500 text-2xl font-bold mb-4 tracking-widest text-center"
        >
          STRENGTH
        </h2>

        <div
          id="display-red"
          class="flex-grow flex flex-col items-center justify-center w-full text-center"
        >
          <div class="text-6xl mb-4">üî¥</div>
          <p class="text-gray-500 italic">Waiting to draft...</p>
        </div>

        <div
          id="controls-red"
          class="hidden w-full flex gap-3 mt-4 pt-4 border-t border-neutral-800"
        >
          <button
            id="btn-veto-red"
            onclick="vetoGem('red')"
            class="flex-1 py-2 px-2 bg-neutral-800 hover:bg-neutral-700 text-gray-400 hover:text-white rounded border border-neutral-600 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Team Veto
          </button>
          <button
            id="btn-risk-red"
            onclick="triggerRiskReroll('red')"
            class="flex-1 py-2 px-2 bg-red-900 hover:bg-red-800 text-red-100 rounded border border-red-700 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Risk It
          </button>
        </div>
        <div
          id="status-red"
          class="hidden mt-4 text-xs uppercase tracking-widest font-bold text-red-500 text-center"
        ></div>
      </div>

      <div
        id="card-green"
        class="gem-card bg-neutral-900 rounded-xl p-6 relative overflow-hidden min-h-[500px]"
      >
        <div
          class="absolute top-0 left-0 w-full h-1 bg-green-600 shadow-[0_0_10px_rgba(22,163,74,0.8)]"
        ></div>
        <h2
          class="text-green-500 text-2xl font-bold mb-4 tracking-widest text-center"
        >
          DEXTERITY
        </h2>

        <div
          id="display-green"
          class="flex-grow flex flex-col items-center justify-center w-full text-center"
        >
          <div class="text-6xl mb-4">üü¢</div>
          <p class="text-gray-500 italic">Waiting to draft...</p>
        </div>

        <div
          id="controls-green"
          class="hidden w-full flex gap-3 mt-4 pt-4 border-t border-neutral-800"
        >
          <button
            id="btn-veto-green"
            onclick="vetoGem('green')"
            class="flex-1 py-2 px-2 bg-neutral-800 hover:bg-neutral-700 text-gray-400 hover:text-white rounded border border-neutral-600 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Team Veto
          </button>
          <button
            id="btn-risk-green"
            onclick="triggerRiskReroll('green')"
            class="flex-1 py-2 px-2 bg-green-900 hover:bg-green-800 text-green-100 rounded border border-green-700 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Risk It
          </button>
        </div>
        <div
          id="status-green"
          class="hidden mt-4 text-xs uppercase tracking-widest font-bold text-green-500 text-center"
        ></div>
      </div>

      <div
        id="card-blue"
        class="gem-card bg-neutral-900 rounded-xl p-6 relative overflow-hidden min-h-[500px]"
      >
        <div
          class="absolute top-0 left-0 w-full h-1 bg-blue-600 shadow-[0_0_10px_rgba(37,99,235,0.8)]"
        ></div>
        <h2
          class="text-blue-500 text-2xl font-bold mb-4 tracking-widest text-center"
        >
          INTELLIGENCE
        </h2>

        <div
          id="display-blue"
          class="flex-grow flex flex-col items-center justify-center w-full text-center"
        >
          <div class="text-6xl mb-4">üîµ</div>
          <p class="text-gray-500 italic">Waiting to draft...</p>
        </div>

        <div
          id="controls-blue"
          class="hidden w-full flex gap-3 mt-4 pt-4 border-t border-neutral-800"
        >
          <button
            id="btn-veto-blue"
            onclick="vetoGem('blue')"
            class="flex-1 py-2 px-2 bg-neutral-800 hover:bg-neutral-700 text-gray-400 hover:text-white rounded border border-neutral-600 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Team Veto
          </button>
          <button
            id="btn-risk-blue"
            onclick="triggerRiskReroll('blue')"
            class="flex-1 py-2 px-2 bg-blue-900 hover:bg-blue-800 text-blue-100 rounded border border-blue-700 transition-colors text-xs uppercase font-bold tracking-wider"
          >
            Risk It
          </button>
        </div>
        <div
          id="status-blue"
          class="hidden mt-4 text-xs uppercase tracking-widest font-bold text-blue-500 text-center"
        ></div>
      </div>
    </div>

    <div class="flex flex-col items-center gap-4 mb-12">
      <button
        onclick="startDraft()"
        id="btn-draft"
        class="px-12 py-4 bg-gradient-to-r from-amber-700 to-amber-600 hover:from-amber-600 hover:to-amber-500 text-white font-bold text-xl rounded shadow-lg transform hover:scale-105 transition-all border border-amber-400 font-serif tracking-wider"
      >
        BEGIN THE DRAFT
      </button>
      <p
        id="instruction-text"
        class="text-gray-500 text-sm mt-2 h-6 font-semibold text-center"
      ></p>
    </div>

    <section
      class="max-w-3xl w-full bg-neutral-900/50 border border-neutral-800 rounded-lg p-8 mb-12"
    >
      <div class="flex border-b border-neutral-700 mb-6">
        <button
          onclick="switchTab('draft')"
          id="tab-draft"
          class="px-4 py-2 text-amber-500 border-b-2 border-amber-500 font-bold focus:outline-none"
        >
          Draft Protocol
        </button>
        <button
          onclick="switchTab('game')"
          id="tab-game"
          class="px-4 py-2 text-gray-500 border-b-2 border-transparent hover:text-gray-300 font-bold focus:outline-none"
        >
          League Rules
        </button>
      </div>
      <div id="content-draft" class="block">
        <ul class="list-disc list-outside pl-5 space-y-3 text-gray-400">
          <li>
            <strong class="text-gray-200">Gem Variants:</strong> Check the list
            to see which Transfigured versions are
            <span class="text-green-500">Legal</span>.
          </li>
          <li>
            <strong class="text-gray-200">The Risk:</strong> Clicking
            <em>Risk It</em>
            <span class="text-red-500 font-bold">LOCKS</span> you to that color.
          </li>
          <li>
            <strong class="text-gray-200">Emergency Veto:</strong> Even after
            locking a color, the <em>Team Veto</em> button remains active. If
            you risk a reroll and land on an illegal gem, the team can veto it
            to respin that specific wheel again.
          </li>
        </ul>
      </div>
      <div id="content-game" class="hidden">
        <ul class="list-disc list-outside pl-5 space-y-3 text-gray-400">
          <li>
            <strong class="text-gray-200">Main Link Rule:</strong> Your drafted
            skill must be your primary damage source.
          </li>
          <li>
            <strong class="text-gray-200">Tag Proxy Leveling:</strong> Level
            with a skill sharing at least 1 gem tag until you get your drafted
            gem. (This is to prevent leveling with Rolling Magma and re-speccing
            at 70, as an example.)
          </li>
          <li>
            <strong class="text-gray-200">Mule Mandate:</strong> Create a mule
            character if your class cannot buy the gem. (If applicable.)
          </li>
          <li>
            <strong class="text-gray-200">Siosa:</strong> Once one person
            reaches the library, others should make a reasonable effort to
            purchase their gem from that person, assuming it is playable for
            their level.
          </li>
        </ul>
      </div>
    </section>

    <section
      class="max-w-3xl w-full bg-black/40 border border-neutral-800 rounded-lg p-8"
    >
      <h3
        class="text-2xl text-gray-300 font-bold mb-6 border-b border-neutral-800 pb-2 text-center"
      >
        League Roster
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div
          class="bg-neutral-900 p-4 rounded border border-neutral-800 flex justify-between items-center"
        >
          <span class="font-bold text-amber-500 text-lg">Austin</span
          ><span class="text-gray-400 font-mono">PENDING</span>
        </div>
        <div
          class="bg-neutral-900 p-4 rounded border border-neutral-800 flex justify-between items-center"
        >
          <span class="font-bold text-amber-500 text-lg">Gavin</span
          ><span class="text-gray-400 font-mono">PENDING</span>
        </div>
        <div
          class="bg-neutral-900 p-4 rounded border border-neutral-800 flex justify-between items-center"
        >
          <span class="font-bold text-amber-500 text-lg">Justin</span
          ><span class="text-gray-400 font-mono">PENDING</span>
        </div>
        <div
          class="bg-neutral-900 p-4 rounded border border-neutral-800 flex justify-between items-center"
        >
          <span class="font-bold text-amber-500 text-lg">Madi</span
          ><span class="text-gray-400 font-mono">PENDING</span>
        </div>
      </div>
    </section>

    <script>
      // --- GEM DATABASE ---
      // Structure: Base Name -> { legal: [variants], illegal: [variants], baseBanned: boolean }

      const redGems = [
        {
          name: 'Absolution',
          base: true,
          legal: ['of Inspiring'],
          illegal: [],
        },
        {
          name: 'Bladestorm',
          base: true,
          legal: ['of Uncertainty'],
          illegal: [],
        },
        {
          name: 'Boneshatter',
          base: false,
          legal: ['of Carnage', 'of Complex Trauma'],
          illegal: [],
        },
        { name: 'Chain Hook', base: true, legal: [], illegal: [] },
        { name: 'Cleave', base: true, legal: ['of Rage'], illegal: [] },
        {
          name: 'Consecrated Path',
          base: true,
          legal: ['of Endurance'],
          illegal: [],
        },
        { name: 'Crushing Fist', base: true, legal: [], illegal: [] },
        { name: 'Divine Retribution', base: true, legal: [], illegal: [] },
        {
          name: 'Dominating Blow',
          base: true,
          legal: ['of Inspiring'],
          illegal: [],
        },
        {
          name: 'Earthquake',
          base: true,
          legal: ['of Amplification'],
          illegal: [],
        },
        {
          name: 'Earthshatter',
          base: false,
          legal: ['of Fragility', 'of Prominence'],
          illegal: [],
        },
        {
          name: 'Frozen Legion',
          base: true,
          legal: ['of Rallying'],
          illegal: [],
        },
        {
          name: 'Glacial Hammer',
          base: true,
          legal: ['of Shattering'],
          illegal: [],
        },
        { name: 'Heavy Strike', base: true, legal: [], illegal: [] },
        {
          name: 'Holy Flame Totem',
          base: true,
          legal: ['of Ire'],
          illegal: [],
        },
        { name: 'Ice Crash', base: true, legal: ['of Cadence'], illegal: [] },
        {
          name: 'Infernal Blow',
          base: true,
          legal: ['of Immolation'],
          illegal: [],
        },
        {
          name: 'Molten Strike',
          base: true,
          legal: [],
          illegal: ['of the Zenith'],
        },
        {
          name: 'Perforate',
          base: true,
          legal: ['of Bloodshed', 'of Duality'],
          illegal: [],
        },
        { name: 'Searing Bond', base: true, legal: [], illegal: [] },
        {
          name: 'Shield Crush',
          base: true,
          legal: ['of the Chieftain'],
          illegal: [],
        },
        { name: 'Static Strike', base: true, legal: [], illegal: [] },
        {
          name: 'Sunder',
          base: true,
          legal: ['of Earthbreaking'],
          illegal: [],
        },
        { name: 'Sweep', base: true, legal: [], illegal: [] },
        { name: 'Swordstorm', base: true, legal: [], illegal: [] },
        {
          name: 'Tectonic Slam',
          base: true,
          legal: ['of Cataclysm'],
          illegal: [],
        },
        { name: 'Vigilant Strike', base: true, legal: [], illegal: [] },
        {
          name: 'Volcanic Fissure',
          base: true,
          legal: ['of Snaking'],
          illegal: [],
        },
      ];

      const greenGems = [
        { name: 'Ambush', base: true, legal: [], illegal: [] },
        {
          name: 'Animate Weapon',
          base: true,
          legal: ['of Self Reflection'],
          illegal: ['of Ranged Arms'],
        },
        {
          name: 'Artillery Ballista',
          base: true,
          legal: ['of Cross Strafe', 'of Focus Fire'],
          illegal: [],
        },
        { name: 'Barrage', base: true, legal: ['of Volley Fire'], illegal: [] },
        { name: 'Bear Trap', base: true, legal: ['of Skewers'], illegal: [] },
        {
          name: 'Blade Blast',
          base: true,
          legal: ['of Dagger Detonation', 'of Unloading'],
          illegal: [],
        },
        {
          name: 'Blade Flurry',
          base: true,
          legal: ['of Incision'],
          illegal: [],
        },
        {
          name: 'Blade Trap',
          base: true,
          legal: ['of Greatswords', 'of Laceration'],
          illegal: [],
        },
        {
          name: 'Bladefall',
          base: true,
          legal: ['of Impaling', 'of Volleys'],
          illegal: [],
        },
        { name: 'Blast Rain', base: true, legal: [], illegal: [] },
        {
          name: 'Blink Arrow',
          base: false,
          legal: ['of Bombarding Clones', 'of Prismatic Clones'],
          illegal: [],
        },
        {
          name: 'Burning Arrow',
          base: true,
          legal: ['of Vigour'],
          illegal: [],
        },
        {
          name: 'Caustic Arrow',
          base: true,
          legal: ['of Poison'],
          illegal: [],
        },
        { name: 'Charged Dash', base: true, legal: [], illegal: [] },
        { name: 'Conflagration', base: true, legal: [], illegal: [] },
        { name: 'Conversion Trap', base: true, legal: [], illegal: [] },
        {
          name: 'Cremation',
          base: true,
          legal: ['of Exhuming'],
          illegal: ['of the Volcano'],
        },
        {
          name: 'Detonate Dead',
          base: false,
          legal: ['of Chain Reaction'],
          illegal: ['of Scavenging'],
        },
        {
          name: 'Double Strike',
          base: true,
          legal: ['of Impaling', 'of Momentum'],
          illegal: [],
        },
        {
          name: 'Dual Strike',
          base: true,
          legal: ['of Ambidexterity'],
          illegal: [],
        },
        {
          name: 'Elemental Hit',
          base: true,
          legal: [],
          illegal: ['of the Spectrum'],
        },
        { name: 'Ensnaring Arrow', base: true, legal: [], illegal: [] },
        {
          name: 'Ethereal Knives',
          base: true,
          legal: ['of Lingering Blades', 'of the Massacre'],
          illegal: [],
        },
        { name: 'Explosive Arrow', base: true, legal: [], illegal: [] },
        {
          name: 'Explosive Concoction',
          base: true,
          legal: ['of Destruction'],
          illegal: [],
        },
        {
          name: 'Explosive Trap',
          base: true,
          legal: ['of Magnitude', 'of Shrapnel'],
          illegal: [],
        },
        { name: 'Flamethrower Trap', base: true, legal: [], illegal: [] },
        {
          name: 'Frost Blades',
          base: true,
          legal: ['of Katabasis'],
          illegal: [],
        },
        {
          name: 'Galvanic Arrow',
          base: true,
          legal: ['of Energy', 'of Surging'],
          illegal: [],
        },
        { name: 'Glacial Shield Swipe', base: true, legal: [], illegal: [] },
        {
          name: 'Ice Shot',
          base: true,
          legal: ['of Penetration'],
          illegal: [],
        },
        { name: 'Ice Trap', base: true, legal: ['of Hollowness'], illegal: [] },
        {
          name: 'Lacerate',
          base: true,
          legal: ['of Butchering'],
          illegal: ['of Haemorrhage'],
        },
        {
          name: 'Lancing Steel',
          base: true,
          legal: [],
          illegal: ['of Spraying'],
        },
        {
          name: 'Lightning Strike',
          base: true,
          legal: [],
          illegal: ['of Arcing'],
        },
        {
          name: 'Mirror Arrow',
          base: true,
          legal: ['of Bombarding Clones', 'of Prismatic Clones'],
          illegal: [],
        },
        { name: 'Pestilent Strike', base: true, legal: [], illegal: [] },
        { name: 'Puncture', base: true, legal: ['of Shanking'], illegal: [] },
        {
          name: 'Rain of Arrows',
          base: true,
          legal: ['of Artillery', 'of Saturation'],
          illegal: [],
        },
        {
          name: 'Scourge Arrow',
          base: true,
          legal: ['of Menace'],
          illegal: [],
        },
        { name: 'Seismic Trap', base: true, legal: ['of Swells'], illegal: [] },
        {
          name: 'Shattering Steel',
          base: true,
          legal: ['of Ammunition'],
          illegal: [],
        },
        {
          name: 'Shrapnel Ballista',
          base: true,
          legal: ['of Steel'],
          illegal: [],
        },
        {
          name: 'Siege Ballista',
          base: true,
          legal: ['of Splintering'],
          illegal: [],
        },
        { name: 'Snipe', base: true, legal: [], illegal: [] },
        { name: 'Spectral Helix', base: true, legal: [], illegal: [] },
        {
          name: 'Spectral Shield Throw',
          base: true,
          legal: ['of Shattering'],
          illegal: [],
        },
        {
          name: 'Spectral Throw',
          base: true,
          legal: ['of Materialising'],
          illegal: [],
        },
        {
          name: 'Split Arrow',
          base: true,
          legal: ['of Splitting'],
          illegal: [],
        },
        {
          name: 'Splitting Steel',
          base: true,
          legal: ['of Ammunition'],
          illegal: [],
        },
        {
          name: 'Storm Rain',
          base: true,
          legal: ['of the Conduit', 'of the Fence'],
          illegal: [],
        },
        { name: 'Thunderstorm', base: true, legal: [], illegal: [] },
        {
          name: 'Tornado',
          base: false,
          legal: ['of Elemental Turbulence'],
          illegal: [],
        },
        {
          name: 'Viper Strike',
          base: true,
          legal: [],
          illegal: ['of the Mamba'],
        },
        { name: 'Whirling Blades', base: true, legal: [], illegal: [] },
        {
          name: 'Wild Strike',
          base: true,
          legal: ['of Extremes'],
          illegal: [],
        },
      ];

      const blueGems = [
        {
          name: 'Arc',
          base: true,
          legal: ['of Oscillating', 'of Surging'],
          illegal: [],
        },
        {
          name: 'Armageddon Brand',
          base: true,
          legal: ['of Recall', 'of Volatility'],
          illegal: [],
        },
        {
          name: 'Ball Lightning',
          base: true,
          legal: ['of Orbiting', 'of Static'],
          illegal: [],
        },
        { name: 'Bane', base: true, legal: ['of Condemnation'], illegal: [] },
        { name: 'Blazing Salvo', base: true, legal: [], illegal: [] },
        {
          name: 'Blight',
          base: true,
          legal: ['of Atrophy', 'of Contagion'],
          illegal: [],
        },
        { name: 'Bodyswap', base: true, legal: ['of Sacrifice'], illegal: [] },
        { name: 'Cold Snap', base: true, legal: ['of Power'], illegal: [] },
        {
          name: 'Contagion',
          base: true,
          legal: ['of Subsiding', 'of Transference'],
          illegal: [],
        },
        {
          name: 'Crackling Lance',
          base: true,
          legal: ['of Branching', 'of Disintegration'],
          illegal: [],
        },
        { name: 'Creeping Frost', base: true, legal: [], illegal: [] },
        { name: 'Dark Pact', base: true, legal: [], illegal: [] },
        { name: 'Discharge', base: true, legal: ['of Misery'], illegal: [] },
        {
          name: 'Divine Ire',
          base: true,
          legal: ['of Disintegration', 'of Holy Lightning'],
          illegal: [],
        },
        {
          name: 'Essence Drain',
          base: true,
          legal: ['of Desperation', 'of Wickedness'],
          illegal: [],
        },
        {
          name: 'Eye of Winter',
          base: true,
          legal: ['of Finality', 'of Transience'],
          illegal: [],
        },
        { name: 'Fireball', base: true, legal: [], illegal: [] },
        {
          name: 'Firestorm',
          base: true,
          legal: ['of Meteors', 'of Pelting'],
          illegal: [],
        },
        {
          name: 'Flame Surge',
          base: true,
          legal: ['of Combusting'],
          illegal: [],
        },
        {
          name: 'Flameblast',
          base: true,
          legal: ['of Celerity', 'of Contraction'],
          illegal: [],
        },
        { name: 'Flame Dash', base: false, legal: ['of Return'], illegal: [] },
        {
          name: 'Forbidden Rite',
          base: true,
          legal: [],
          illegal: ['of Soul Sacrifice'],
        },
        { name: 'Freezing Pulse', base: true, legal: [], illegal: [] },
        {
          name: 'Frost Bomb',
          base: true,
          legal: ['of Forthcoming', 'of Instability'],
          illegal: [],
        },
        {
          name: 'Frostblink',
          base: false,
          legal: ['of Wintry Blast'],
          illegal: [],
        },
        { name: 'Frostbolt', base: true, legal: [], illegal: [] },
        {
          name: 'Galvanic Field',
          base: true,
          legal: ['of Intensity'],
          illegal: [],
        },
        {
          name: 'Glacial Cascade',
          base: true,
          legal: ['of the Fissure'],
          illegal: [],
        },
        {
          name: 'Hexblast',
          base: true,
          legal: ['of Contradiction', 'of Havoc'],
          illegal: [],
        },
        {
          name: 'Ice Nova',
          base: true,
          legal: ['of Deep Freeze'],
          illegal: ['of Frostbolts'],
        },
        { name: 'Ice Spear', base: true, legal: [], illegal: ['of Splitting'] },
        {
          name: 'Icicle Mine',
          base: true,
          legal: ['of Fanning', 'of Sabotage'],
          illegal: [],
        },
        {
          name: 'Incinerate',
          base: true,
          legal: ['of Expanse', 'of Venting'],
          illegal: [],
        },
        {
          name: 'Kinetic Bolt',
          base: true,
          legal: ['of Fragmentation'],
          illegal: [],
        },
        { name: 'Kinetic Rain', base: true, legal: ['of Impact'], illegal: [] },
        {
          name: 'Lightning Conduit',
          base: true,
          legal: ['of the Heavens'],
          illegal: [],
        },
        {
          name: 'Lightning Spire Trap',
          base: true,
          legal: ['of Overloading', 'of Zapping'],
          illegal: [],
        },
        {
          name: 'Lightning Tendrils',
          base: true,
          legal: ['of Eccentricity', 'of Escalation'],
          illegal: [],
        },
        {
          name: 'Lightning Trap',
          base: true,
          legal: ['of Sparking'],
          illegal: [],
        },
        { name: 'Lightning Warp', base: true, legal: [], illegal: [] },
        { name: 'Magma Orb', base: true, legal: [], illegal: [] },
        { name: 'Manabond', base: true, legal: [], illegal: [] },
        { name: 'Orb of Storms', base: true, legal: [], illegal: [] },
        {
          name: 'Penance Brand',
          base: true,
          legal: ['of Conduction'],
          illegal: ['of Dissipation'],
        },
        {
          name: 'Power Siphon',
          base: true,
          legal: ['of the Archmage'],
          illegal: [],
        },
        {
          name: 'Purifying Flame',
          base: true,
          legal: ['of Revelations'],
          illegal: [],
        },
        {
          name: 'Pyroclast Mine',
          base: true,
          legal: ['of Sabotage'],
          illegal: [],
        },
        {
          name: 'Raise Zombie',
          base: true,
          legal: ['of Falling', 'of Slamming'],
          illegal: [],
        },
        {
          name: 'Scorching Ray',
          base: true,
          legal: ['of Immolation'],
          illegal: [],
        },
        { name: 'Siphoning Trap', base: true, legal: [], illegal: [] },
        { name: 'Somatic Shell', base: true, legal: [], illegal: [] },
        {
          name: 'Soulrend',
          base: true,
          legal: ['of Reaping', 'of the Spiral'],
          illegal: [],
        },
        {
          name: 'Spark',
          base: true,
          legal: ['of Unpredictability'],
          illegal: ['of the Nova'],
        },
        {
          name: 'Storm Brand',
          base: true,
          legal: ['of Indecision'],
          illegal: [],
        },
        { name: 'Storm Burst', base: true, legal: [], illegal: [] },
        { name: 'Storm Call', base: true, legal: [], illegal: [] },
        {
          name: 'Stormbind',
          base: true,
          legal: ['of Teleportation'],
          illegal: [],
        },
        { name: 'Stormblast Mine', base: true, legal: [], illegal: [] },
        {
          name: 'Summon Reaper',
          base: true,
          legal: ['of Eviscerating', 'of Revenants'],
          illegal: [],
        },
        {
          name: 'Summon Skeletons',
          base: true,
          legal: ['of Archers', 'of Mages'],
          illegal: [],
        },
        { name: 'Tempest Shield', base: true, legal: [], illegal: [] },
        { name: 'Voltaxic Burst', base: true, legal: [], illegal: [] },
        { name: 'Vortex', base: true, legal: ['of Projection'], illegal: [] },
        {
          name: 'Wave of Conviction',
          base: true,
          legal: [],
          illegal: ['of Trarthus'],
        },
        { name: 'Winter Orb', base: true, legal: [], illegal: [] },
        { name: 'Wintertide Brand', base: true, legal: [], illegal: [] },
      ];

      let hasRerolled = false;
      let lockedColor = null;

      function startDraft() {
        resetUI();
        hasRerolled = false;
        lockedColor = null;

        document.getElementById('btn-draft').innerText = 'Redrafting...';
        document.getElementById('btn-draft').disabled = true;
        document.getElementById('instruction-text').innerText =
          'Fate is spinning...';

        spinWheel('red', redGems, 1000);
        spinWheel('green', greenGems, 1500);
        spinWheel('blue', blueGems, 2000);

        setTimeout(() => {
          document.getElementById('btn-draft').innerText = 'Draft Again';
          document.getElementById('btn-draft').disabled = false;

          document.getElementById('controls-red').classList.remove('hidden');
          document.getElementById('controls-green').classList.remove('hidden');
          document.getElementById('controls-blue').classList.remove('hidden');
          document.getElementById('instruction-text').innerText =
            'Make your choice, or risk a reroll.';
        }, 2100);
      }

      function spinWheel(color, pool, duration) {
        const display = document.getElementById(`display-${color}`);
        let startTime = null;

        function animate(timestamp) {
          if (!startTime) startTime = timestamp;
          const progress = timestamp - startTime;

          const randomGem = pool[Math.floor(Math.random() * pool.length)];
          // Keep the spinner centered as well
          display.innerHTML = `
            <div class="flex flex-col items-center justify-center h-full w-full">
                <div class="gem-icon gem-${color} opacity-50 scale-75"></div>
                <div class="text-xl text-gray-500 opacity-70 spin-animation font-bold">${randomGem.name}</div>
            </div>`;

          if (progress < duration) {
            requestAnimationFrame(animate);
          } else {
            const finalGem = pool[Math.floor(Math.random() * pool.length)];
            displayGem(color, finalGem);
          }
        }
        requestAnimationFrame(animate);
      }

      function displayGem(color, gemData) {
        const display = document.getElementById(`display-${color}`);
        const wikiLink = `https://www.poewiki.net/wiki/${gemData.name.replace(
          / /g,
          '_'
        )}`;

        let variantsHtml = '';

        if (gemData.base) {
          variantsHtml += `<div class="variant-row flex justify-between items-center py-1 text-xs w-full">
                    <span class="text-gray-400">Base Gem</span>
                    <span class="text-green-400 font-bold">‚úÖ LEGAL</span>
                </div>`;
        } else {
          variantsHtml += `<div class="variant-row flex justify-between items-center py-1 text-xs w-full opacity-60">
                    <span class="text-gray-500">Base Gem</span>
                    <span class="text-red-500 font-bold">‚ùå BANNED</span>
                </div>`;
        }

        gemData.legal.forEach((v) => {
          variantsHtml += `<div class="variant-row flex justify-between items-center py-1 text-xs w-full">
                    <span class="text-gray-300">${v}</span>
                    <span class="text-green-400 font-bold">‚úÖ LEGAL</span>
                </div>`;
        });

        gemData.illegal.forEach((v) => {
          variantsHtml += `<div class="variant-row flex justify-between items-center py-1 text-xs w-full opacity-60">
                    <span class="text-gray-500">${v}</span>
                    <span class="text-red-500 font-bold">‚ùå BANNED</span>
                </div>`;
        });

        // Added justify-center to the wrapper div to lower the content
        // Added the "gem-icon" div to simulate a picture
        display.innerHTML = `
                <div class="flex flex-col w-full h-full justify-center items-center">
                    <div class="gem-icon gem-${color}"></div>
                    
                    <a href="${wikiLink}" target="_blank" class="group mb-4 w-full">
                        <div class="text-3xl md:text-4xl font-bold text-${color}-400 group-hover:text-${color}-300 transition-colors text-center px-2 leading-tight">
                            ${gemData.name}
                        </div>
                        <div class="text-xs text-gray-500 mt-1 group-hover:text-gray-300 text-center">View Wiki ‚Üó</div>
                    </a>
                    
                    <div class="bg-black/40 rounded p-2 overflow-y-auto max-h-[200px] w-full border border-neutral-800">
                        ${variantsHtml}
                    </div>
                </div>
            `;
      }

      function getPool(color) {
        if (color === 'red') return redGems;
        if (color === 'green') return greenGems;
        if (color === 'blue') return blueGems;
        return [];
      }

      function vetoGem(color) {
        // Allow veto if locked ONLY if this is the locked color
        if (hasRerolled && lockedColor !== color) return;

        const pool = getPool(color);
        spinWheel(color, pool, 800);
      }

      function triggerRiskReroll(color) {
        if (hasRerolled) return;

        try {
          if (
            !confirm(
              `CONTRACT WARNING:\n\nAre you sure you want to reroll ${color.toUpperCase()}?\n\n1. You will be FORCED to play this COLOR.\n2. Other colors will be discarded.\n3. You cannot go back.`
            )
          ) {
            return;
          }
        } catch (e) {
          console.error(e);
        }

        hasRerolled = true;
        lockedColor = color;

        // Hide controls for OTHER colors and Dim them
        const colors = ['red', 'green', 'blue'];
        colors.forEach((c) => {
          if (c !== color) {
            document.getElementById(`controls-${c}`).classList.add('hidden');
            document.getElementById(`card-${c}`).classList.add('dimmed-card');
          }
        });

        // On chosen color: hide Risk button, keep Veto button
        document.getElementById(`btn-risk-${color}`).classList.add('hidden');

        // Hide main draft button
        document.getElementById('btn-draft').classList.add('hidden');

        const pool = getPool(color);
        spinWheel(color, pool, 2000);

        setTimeout(() => {
          lockSelection(color);
        }, 2100);
      }

      function lockSelection(chosenColor) {
        const card = document.getElementById(`card-${chosenColor}`);
        const status = document.getElementById(`status-${chosenColor}`);

        card.classList.add('locked-gem');
        card.classList.remove('dimmed-card');

        status.innerText = 'CONTRACT SEALED (VETO ALLOWED)';
        status.classList.remove('hidden');
        status.classList.add('locked-text');

        document.getElementById(
          'instruction-text'
        ).innerHTML = `<span class="text-amber-500 font-bold">CONTRACT SEALED.</span> Veto allowed if illegal.`;
      }

      function resetUI() {
        const colors = ['red', 'green', 'blue'];
        colors.forEach((c) => {
          const card = document.getElementById(`card-${c}`);
          const status = document.getElementById(`status-${c}`);
          card.classList.remove('locked-gem');
          card.classList.remove('dimmed-card');
          status.classList.add('hidden');
          status.innerText = '';
          document.getElementById(`controls-${c}`).classList.add('hidden');
          document.getElementById(`btn-risk-${c}`).classList.remove('hidden'); // Restore risk buttons
        });
        document.getElementById('btn-draft').classList.remove('hidden');
        document.getElementById('instruction-text').innerText = '';
        hasRerolled = false;
        lockedColor = null;
      }

      function switchTab(tab) {
        const draftTab = document.getElementById('tab-draft');
        const gameTab = document.getElementById('tab-game');

        if (tab === 'draft') {
          draftTab.classList.add('text-amber-500', 'border-amber-500');
          draftTab.classList.remove('text-gray-500', 'border-transparent');
          gameTab.classList.add('text-gray-500', 'border-transparent');
          gameTab.classList.remove('text-amber-500', 'border-amber-500');
          document.getElementById('content-draft').classList.remove('hidden');
          document.getElementById('content-game').classList.add('hidden');
        } else {
          gameTab.classList.add('text-amber-500', 'border-amber-500');
          gameTab.classList.remove('text-gray-500', 'border-transparent');
          draftTab.classList.add('text-gray-500', 'border-transparent');
          draftTab.classList.remove('text-amber-500', 'border-amber-500');
          document.getElementById('content-game').classList.remove('hidden');
          document.getElementById('content-draft').classList.add('hidden');
        }
      }
    </script>
  </body>
</html>
